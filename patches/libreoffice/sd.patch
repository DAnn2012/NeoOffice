--- source/core/drawdoc.cxx.bak	2015-11-25 04:55:38.000000000 -0800
+++ source/core/drawdoc.cxx	2016-12-08 17:07:22.000000000 -0800
@@ -691,6 +691,12 @@
     {
         pDocLockedInsertingLinks = this; // lock inserting links. only links in this document should by resolved
 
+        if (mpDocSh)
+        {
+            comphelper::EmbeddedObjectContainer& rEmbeddedObjectContainer = mpDocSh->getEmbeddedObjectContainer();
+            rEmbeddedObjectContainer.setUserAllowsLinkUpdate(true);
+        }
+
         pLinkManager->UpdateAllLinks();  // query box: update all links?
 
         if( pDocLockedInsertingLinks == this )
--- source/ui/docshell/docshel4.cxx.bak	2015-11-25 04:55:38.000000000 -0800
+++ source/ui/docshell/docshel4.cxx	2016-12-08 17:08:54.000000000 -0800
@@ -288,8 +288,11 @@
     }
 
     bRet = SfxObjectShell::Load( rMedium );
-    if( bRet )
+    if (bRet)
     {
+        comphelper::EmbeddedObjectContainer& rEmbeddedObjectContainer = getEmbeddedObjectContainer();
+        rEmbeddedObjectContainer.setUserAllowsLinkUpdate(false);
+
         bRet = SdXMLFilter( rMedium, *this, true, SDXMLMODE_Normal, SotStorage::GetVersion( rMedium.GetStorage() ) ).Import( nError );
     }
 
